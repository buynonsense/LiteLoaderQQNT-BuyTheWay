# LiteLoaderQQNT-BuyTheWay v1.1.4 发布说明

## 🚨 紧急修复版本

本版本主要修复了一个影响图片转发功能的关键 bug，强烈建议所有用户更新。

## 🔧 核心修复

### Windows 路径双斜线问题
- **问题描述**: 在 Windows 系统中，插件生成的图片路径包含双反斜杠（如 `C:\\\\Users\\\\...`），导致文件系统无法正确识别文件
- **影响范围**: 所有 Windows 用户的图片转发功能
- **修复方案**: 
  - 新增 `normalizePath` 方法，自动标准化路径格式
  - 在文件访问前统一进行路径处理
  - 确保生成的所有路径变体都是标准格式

### 具体修复内容
1. **路径标准化处理**
   ```javascript
   // 修复前：C:\\\\Users\\\\buynonsense\\\\Documents\\\\...
   // 修复后：C:\\Users\\buynonsense\\Documents\\...
   ```

2. **文件访问验证增强**
   - 在 `isFileAccessible` 方法中集成路径标准化
   - 确保传递给文件系统 API 的路径格式正确

3. **路径变体生成优化**
   - 在生成路径变体后统一应用标准化处理
   - 避免重复的异常路径进入检查流程

## 🎯 问题根源分析

用户报告的问题症状：
- 图片文件在文件系统中确实存在
- 手动访问路径（去掉双斜线）可以成功
- 插件检测时显示"文件不存在"

这表明问题出现在路径格式处理上，而非文件访问逻辑本身。

## 🚀 性能提升

- **更快的文件检测**: 标准化路径减少了文件系统的解析负担
- **更高的成功率**: 避免因路径格式问题导致的误判
- **更好的兼容性**: 支持各种异常路径格式的自动修复

## 📋 测试验证

本版本包含专门的路径标准化测试：
- 验证双斜线路径的正确处理
- 确保各种路径格式的兼容性
- 测试文件访问的准确性

## 🔄 升级说明

### 自动升级
如果你使用的是支持自动更新的 LiteLoader 版本，插件将自动更新到 v1.1.4。

### 手动升级
1. 下载最新版本文件
2. 替换原有插件文件
3. 重启 QQ 应用
4. 验证图片转发功能正常工作

## 🐛 如何验证修复

更新后，请测试以下场景：
1. 发送包含图片的消息到监控群组
2. 观察控制台日志，确认路径格式正确
3. 验证图片成功包含在转发的邮件或消息中

## 📞 问题反馈

如果更新后仍然遇到图片转发问题，请提供：
- 详细的控制台日志
- 系统环境信息（Windows 版本、QQ 版本）
- 具体的复现步骤

---

**发布日期**: 2025年5月26日  
**版本号**: v1.1.4  
**紧急程度**: 高 - 建议立即更新
